# Masuit.Tools
[![LICENSE](https://img.shields.io/badge/license-Anti%20996-blue.svg)](https://github.com/996icu/996.ICU/blob/master/LICENSE) [![nuget](https://img.shields.io/nuget/v/Masuit.Tools.Core.svg)](https://www.nuget.org/packages/Masuit.Tools.Core) [![nuget](https://img.shields.io/nuget/dt/Masuit.Tools.Core.svg)](https://www.nuget.org/packages/Masuit.Tools.Core) ![codeSize](https://img.shields.io/github/languages/code-size/ldqk/Masuit.Tools.svg) ![language](https://img.shields.io/github/languages/top/ldqk/Masuit.Tools.svg) <a href="https://gitee.com/masuit/Masuit.Tools"><img src="https://gitee.com/static/images/logo-black.svg" height="24"></a> <a href="https://github.com/ldqk/Masuit.Tools"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Font_Awesome_5_brands_github.svg/54px-Font_Awesome_5_brands_github.svg.png" height="24"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/GitHub_logo_2013.svg/128px-GitHub_logo_2013.svg.png" height="24"></a>  
åŒ…å«ä¸€äº›å¸¸ç”¨çš„æ“ä½œç±»ï¼Œå¤§éƒ½æ˜¯é™æ€ç±»ï¼ŒåŠ å¯†è§£å¯†ï¼Œåå°„æ“ä½œï¼Œæƒé‡éšæœºç­›é€‰ç®—æ³•ï¼Œåˆ†å¸ƒå¼çŸ­idï¼Œè¡¨è¾¾å¼æ ‘ï¼Œlinqæ‰©å±•ï¼Œæ–‡ä»¶å‹ç¼©ï¼Œå¤šçº¿ç¨‹ä¸‹è½½å’ŒFTPå®¢æˆ·ç«¯ï¼Œç¡¬ä»¶ä¿¡æ¯ï¼Œå­—ç¬¦ä¸²æ‰©å±•æ–¹æ³•ï¼Œæ—¥æœŸæ—¶é—´æ‰©å±•æ“ä½œï¼Œä¸­å›½å†œå†ï¼Œå¤§æ–‡ä»¶æ‹·è´ï¼Œå›¾åƒè£å‰ªï¼ŒéªŒè¯ç ï¼Œæ–­ç‚¹ç»­ä¼ ï¼Œé›†åˆæ‰©å±•ã€Excelå¯¼å‡ºç­‰å¸¸ç”¨å°è£…ã€‚**è¯¸å¤šåŠŸèƒ½é›†ä¸€èº«ï¼Œä»£ç é‡ä¸åˆ°2MBï¼**  
[å®˜ç½‘æ•™ç¨‹](https://masuit.com/55)  
![Masuit Tools](https://user-images.githubusercontent.com/20254980/208012013-28813c43-daa2-4b64-9e4a-78829325a7a4.png)


é¡¹ç›®å¼€å‘æ¨¡å¼ï¼šæ—¥å¸¸ä»£ç ç§¯ç´¯+ç½‘ç»œæœé›†  
â­â­â­å–œæ¬¢è¿™ä¸ªé¡¹ç›®çš„è¯å°±Starã€Forkã€Followç´ è´¨ä¸‰è¿å…³â™‚æ³¨ä¸€ä¸‹å§â­â­â­  
å…³äºæœ¬é¡¹ç›®ï¼Œå¦‚æœä½ æœ‰ä»»ä½•ä¸æ‡‚çš„åœ°æ–¹æˆ–ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œå¯ä»¥ç›´æ¥æissueæˆ–ç§ä¿¡è”ç³»æˆ‘ï¼Œæˆ‘ä¼šä¸ºä½ æä¾›**å®Œå…¨å…è´¹**çš„æŠ€æœ¯æŒ‡å¯¼ï¼Œå½“ç„¶ï¼Œå¦‚æœä½ è§‰å¾—ä¸å¥½æ„æ€æ¥å—å…è´¹çš„æŒ‡å¯¼ï¼Œæƒ³é€‚å½“æ‰“èµæˆ‘ä¹Ÿæ˜¯ä¸ä¼šæ‹’ç»çš„ï¼ğŸ¤£ğŸ¤£ğŸ¤£
## æœ¬é¡¹ç›®å·²å¾—åˆ°[JetBrains](https://www.jetbrains.com/shop/eform/opensource)çš„æ”¯æŒï¼  
<img src="https://www.jetbrains.com/shop/static/images/jetbrains-logo-inv.svg" height="100">     

## Starè¶‹åŠ¿
<img src="https://starchart.cc/ldqk/Masuit.Tools.svg">    

## è¯·æ³¨æ„ï¼š
ä¸€æ—¦ä½¿ç”¨æœ¬å¼€æºé¡¹ç›®ä»¥åŠå¼•ç”¨äº†æœ¬é¡¹ç›®æˆ–åŒ…å«æœ¬é¡¹ç›®ä»£ç çš„å…¬å¸å› ä¸ºè¿ååŠ³åŠ¨æ³•ï¼ˆåŒ…æ‹¬ä½†ä¸é™å®šéæ³•è£å‘˜ã€è¶…æ—¶ç”¨å·¥ã€é›‡ä½£ç«¥å·¥ç­‰ï¼‰åœ¨ä»»ä½•æ³•å¾‹è¯‰è®¼ä¸­è´¥è¯‰çš„ï¼Œä¸€ç»å‘ç°ï¼Œæœ¬é¡¹ç›®ä½œè€…æœ‰æƒåˆ©è¿½è®¨æœ¬é¡¹ç›®çš„ä½¿ç”¨è´¹ï¼ˆ**å…¬å¸å·¥å•†æ³¨å†Œä¿¡æ¯è®¤ç¼´é‡‘é¢çš„2-5å€ä½œä¸ºæœ¬é¡¹ç›®çš„æˆæƒè´¹**ï¼‰ï¼Œæˆ–è€…ç›´æ¥ä¸å…è®¸ä½¿ç”¨ä»»ä½•åŒ…å«æœ¬é¡¹ç›®çš„æºä»£ç ï¼ä»»ä½•æ€§è´¨çš„`å¤–åŒ…å…¬å¸`æˆ–`996å…¬å¸`éœ€è¦ä½¿ç”¨æœ¬ç±»åº“ï¼Œè¯·è”ç³»ä½œè€…è¿›è¡Œå•†ä¸šæˆæƒï¼å…¶ä»–ä¼ä¸šæˆ–ä¸ªäººå¯éšæ„ä½¿ç”¨ä¸å—é™ã€‚996é‚£å«ç”¨äººï¼Œä¹Ÿæ˜¯åºŸäººã€‚8å°æ—¶å·¥ä½œåˆ¶æ‰å¯ä»¥è®©ä½ æœ‰æ—¶é—´è‡ªæˆ‘æå‡ï¼Œå°†æ¥æœ‰ç«äº‰åŠ›ã€‚åå¯¹996ï¼Œäººäººæœ‰è´£ï¼

## å»ºè®®å¼€å‘ç¯å¢ƒ
æ“ä½œç³»ç»Ÿï¼šWindows 10 1903åŠä»¥ä¸Šç‰ˆæœ¬  
å¼€å‘å·¥å…·ï¼šVisualStudio2019 v16.5åŠä»¥ä¸Šç‰ˆæœ¬  
SDKï¼š.Net Core 2.1.0åŠä»¥ä¸Šæ‰€æœ‰ç‰ˆæœ¬

## å®‰è£…ç¨‹åºåŒ…
### åŸºç¡€åŠŸèƒ½åŒ…
`.NET Frameworkç‰ˆæœ¬çš„åŒ…å› æ‰“åŒ…ç¯å¢ƒå¼‚å¸¸ï¼Œæ— æ³•æ­£å¸¸å‘å¸ƒæ›´æ–°ï¼Œç›®å‰æš‚æ—¶åœæ›´~`
#### .NET Framework â‰¥ 4.6.1
```shell
PM> Install-Package Masuit.Tools.Net
```
#### .NET Standard â‰¥ 2.1 æˆ–åªæƒ³ä½¿ç”¨ä¸€äº›åŸºæœ¬åŠŸèƒ½
`é€šç”¨é¡¹ç›®æ¨èé¦–é€‰åŒ…`
```shell
PM> Install-Package Masuit.Tools.Abstraction
```
#### .NET Core â‰¥ 2.1
`.NET Coreé¡¹ç›®æ¨èé¦–é€‰åŒ…`
```shell
PM> Install-Package Masuit.Tools.Core
```
#### .NET Framework 4.5ç‰¹ä¾›ç‰ˆ  
è¯·æ³¨æ„ï¼š`è¿™æ˜¯.NET Framework 4.5çš„ä¸“ç”¨ç‰ˆæœ¬ï¼Œç›¸æ¯”4.6.1åŠ.NET Coreçš„ç‰ˆæœ¬ï¼Œé˜‰å‰²äº†Redisã€HTMLã€æ–‡ä»¶å‹ç¼©ã€ASP.NETæ‰©å±•ã€ç¡¬ä»¶ç›‘æµ‹ã€Sessionæ‰©å±•ç­‰ä¸€äº›åŠŸèƒ½ã€‚`**å¦‚æœä½ çš„é¡¹ç›®ç‰ˆæœ¬é«˜äº4.5ï¼Œè¯·åŠ¡å¿…ä½¿ç”¨ä¸Šè¿°ç‰ˆæœ¬çš„åŒ…ï¼Œä»¥äº«å—å®Œæ•´çš„åŠŸèƒ½ä½“éªŒï¼**
```shell
PM> Install-Package Masuit.Tools.Net45
```
### å¢å€¼åŒ…
#### Masuit.Tools.AspNetCore
`AspNetCoreé¡¹ç›®æ¨èé¦–é€‰åŒ…`  
ASP.NET Core Webä¸“ç”¨åŒ…ï¼ŒåŒ…å«Masuit.Tools.Coreçš„å…¨éƒ¨åŠŸèƒ½ï¼Œå¹¶ä¸”å¢åŠ äº†ä¸€äº›å¯¹ASP.NET Core WebåŠŸèƒ½çš„é¢å¤–æ”¯æŒã€‚
#### Masuit.Tools.Excel
Excelå¯¼å…¥å¯¼å‡ºçš„ä¸“ç”¨ç‹¬ç«‹åŒ…
#### Masuit.Tools.NoSQL.MongoDBClient
mongodbçš„å°è£…æ“ä½œç±»ç‹¬ç«‹åŒ…

## ä¸ºå·¥å…·åº“æ³¨å†Œé…ç½®
å·¥å…·åº“éœ€è¦ç”¨åˆ°å¤–éƒ¨é…ç½®èŠ‚ï¼Œ.NET Frameworké¡¹ç›®é…ç½®åœ¨web.config/app.configçš„AppSettingsé…ç½®èŠ‚ä¸­ï¼Œ.NET Coreé¡¹ç›®é…ç½®åœ¨appsettings.jsonä¸­ï¼š  
1. EmailDomainWhiteListï¼Œé‚®ç®±æ ¡éªŒéœ€è¦ç”¨åˆ°çš„ç™½åå•åŸŸåï¼Œè‹±æ–‡é€—å·åˆ†éš”ï¼Œæ¯ä¸ªå…ƒç´ æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼Œè‹¥æœªé…ç½®ï¼Œåˆ™ä¸å¯ç”¨é‚®ç®±æ ¡éªŒç™½åå•ï¼Œç¤ºä¾‹: `"^\\w{1,5}@qq.com,^\\w{1,5}@163.com,^\\w{1,5}@gmail.com,^\\w{1,5}@outlook.com"`
2. EmailDomainBlockListï¼Œé‚®ç®±æ ¡éªŒéœ€è¦ç”¨åˆ°çš„é»‘åå•åŸŸåï¼Œè‹±æ–‡é€—å·åˆ†éš”ï¼Œæ¯ä¸ªå…ƒç´ æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼Œä¸”é»‘åå•ä¼˜å…ˆçº§é«˜äºç™½åå•ï¼Œè‹¥æœªé…ç½®ï¼Œåˆ™ä¸å¯ç”¨é‚®ç®±æ ¡éªŒé»‘ç™½åå•
```csharp
public Startup(IConfiguration configuration)
{
    configuration.AddToMasuitTools(); // è‹¥æœªè°ƒç”¨ï¼Œåˆ™é»˜è®¤è‡ªåŠ¨å°è¯•åŠ è½½appsettings.json
}
```
## ç‰¹è‰²åŠŸèƒ½ç¤ºä¾‹ä»£ç 
### åœ¨çº¿ä½“éªŒ
https://replit.com/@ldqk/MasuitToolsDemo?v=1#main.cs
### 1.æ£€éªŒå­—ç¬¦ä¸²æ˜¯å¦æ˜¯Emailã€æ‰‹æœºå·ã€URLã€IPåœ°å€ã€èº«ä»½è¯å·ç­‰
```csharp
var (isMatch, match) = "337845818@qq.com".MatchEmail(); // å¯åœ¨appsetting.jsonä¸­æ·»åŠ EmailDomainWhiteListå’ŒEmailDomainBlockListé…ç½®é‚®ç®±åŸŸåé»‘ç™½åå•ï¼Œé€—å·åˆ†éš”ï¼Œå¦‚"EmailDomainBlockList": "^\\w{1,5}@qq.com,^\\w{1,5}@163.com,^\\w{1,5}@gmail.com,^\\w{1,5}@outlook.com",
bool isInetAddress = "114.114.114.114".MatchInetAddress();
bool isUrl = "http://ldqk.org/20/history".MatchUrl();
bool isPhoneNumber = "15205201520".MatchPhoneNumber();
bool isIdentifyCard = "312000199502230660".MatchIdentifyCard();// æ ¡éªŒä¸­å›½å¤§é™†èº«ä»½è¯å·
bool isCNPatentNumber = "200410018477.9".MatchCNPatentNumber(); // æ ¡éªŒä¸­å›½ä¸“åˆ©ç”³è¯·å·æˆ–ä¸“åˆ©å·ï¼Œæ˜¯å¦å¸¦æ ¡éªŒä½ï¼Œæ ¡éªŒä½å‰æ˜¯å¦å¸¦â€œ.â€ï¼Œéƒ½å¯ä»¥æ ¡éªŒï¼Œå¾…æ ¡éªŒçš„å·ç å‰ä¸è¦å¸¦CNã€ZLå­—æ ·çš„å‰ç¼€
```

### 2.ç¡¬ä»¶ç›‘æµ‹(ä»…æ”¯æŒWindowsï¼Œéƒ¨åˆ†å‡½æ•°ä»…æ”¯æŒç‰©ç†æœºæ¨¡å¼)
```csharp
float load = SystemInfo.CpuLoad;// è·å–CPUå ç”¨ç‡
long physicalMemory = SystemInfo.PhysicalMemory;// è·å–ç‰©ç†å†…å­˜æ€»æ•°
long memoryAvailable = SystemInfo.MemoryAvailable;// è·å–ç‰©ç†å†…å­˜å¯ç”¨ç‡
double freePhysicalMemory = SystemInfo.GetFreePhysicalMemory();// è·å–å¯ç”¨ç‰©ç†å†…å­˜
double temperature = SystemInfo.GetCPUTemperature();// è·å–CPUæ¸©åº¦
int cpuCount = SystemInfo.GetCpuCount();// è·å–CPUæ ¸å¿ƒæ•°
var ipAddress = SystemInfo.GetLocalIPs();// è·å–æœ¬æœºæ‰€æœ‰IPåœ°å€
string localUsedIp = SystemInfo.GetLocalUsedIP();// è·å–æœ¬æœºå½“å‰æ­£åœ¨ä½¿ç”¨çš„IPåœ°å€
IList<string> macAddress = SystemInfo.GetMacAddress();// è·å–æœ¬æœºæ‰€æœ‰ç½‘å¡macåœ°å€
string osVersion = Windows.GetOsVersion();// è·å–æ“ä½œç³»ç»Ÿç‰ˆæœ¬
RamInfo ramInfo = SystemInfo.GetRamInfo();// è·å–å†…å­˜ä¿¡æ¯
var cpuSN=SystemInfo.GetCpuInfo()[0].SerialNumber; // CPUåºåˆ—å·
var driveSN=SystemInfo.GetDiskInfo()[0].SerialNumber; // ç¡¬ç›˜åºåˆ—å·

// å¿«é€Ÿæ–¹æ³•
var cpuInfos = CpuInfo.Locals; // å¿«é€Ÿè·å–CPUçš„ä¿¡æ¯
var ramInfo = RamInfo.Local; // å¿«é€Ÿè·å–å†…å­˜çš„ä¿¡æ¯
var diskInfos = DiskInfo.Locals; // å¿«é€Ÿè·å–ç¡¬ç›˜çš„ä¿¡æ¯
var biosInfo = BiosInfo.Local; // å¿«é€Ÿè·å–ä¸»æ¿çš„ä¿¡æ¯
```
### 3.htmlçš„é˜²XSSå¤„ç†ï¼š
```csharp
string html = @"<link href='/Content/font-awesome/css' rel='stylesheet'/>
        <!--[if IE 7]>
        <link href='/Content/font-awesome-ie7.min.css' rel='stylesheet'/>
        <![endif]-->
        <script src='/Scripts/modernizr'></script>
        <div id='searchBox' role='search'>
        <form action='/packages' method='get'>
        <span class='user-actions'><a href='/users/account/LogOff'>é€€å‡º</a></span>
        <input name='q' id='searchBoxInput'/>
        <input id='searchBoxSubmit' type='submit' value='Submit' />
        </form>
        </div>";
string s = html.HtmlSantinizerStandard();//æ¸…ç†åï¼š<div><span><a href="/users/account/LogOff">é€€å‡º</a></span></div>
```
### 4.æ•´ç†Windowsç³»ç»Ÿçš„å†…å­˜ï¼š
ç±»ä¼¼äºå„å¤§ç³»ç»Ÿä¼˜åŒ–è½¯ä»¶çš„åŠ é€ŸçƒåŠŸèƒ½
```csharp
Windows.ClearMemorySilent();
```
### 5.ä»»æ„è¿›åˆ¶è½¬æ¢
å¯ç”¨äºç”ŸæˆçŸ­idï¼ŒçŸ­hashï¼Œéšæœºå­—ç¬¦ä¸²ç­‰æ“ä½œï¼Œçº¯æ•°å­¦è¿ç®—ã€‚
```csharp
NumberFormater nf = new NumberFormater(36);//å†…ç½®2-62è¿›åˆ¶çš„è½¬æ¢
//NumberFormater nf = new NumberFormater("0123456789abcdefghijklmnopqrstuvwxyz");// è‡ªå®šä¹‰è¿›åˆ¶å­—ç¬¦ï¼Œå¯ç”¨äºç”ŸæˆéªŒè¯ç 
string s36 = nf.ToString(12345678);
long num = nf.FromString("7clzi");
Console.WriteLine("12345678çš„36è¿›åˆ¶æ˜¯ï¼š" + s36); // 7clzi
Console.WriteLine("36è¿›åˆ¶çš„7clziæ˜¯ï¼š" + num); // 12345678
var s = new NumberFormater(62).ToString(new Random().Next(100000, int.MaxValue)); //é…åˆéšæœºæ•°ç”Ÿæˆéšæœºå­—ç¬¦ä¸²
```
```csharp
//æ‰©å±•æ–¹æ³•å½¢å¼è°ƒç”¨
var bin=12345678.ToBase(36);// 10è¿›åˆ¶è½¬36è¿›åˆ¶ï¼š7clzi
var num="7clzi".FromBase(36);// 36è¿›åˆ¶è½¬10è¿›åˆ¶ï¼š12345678
```
```csharp
//è¶…å¤§æ•°å­—çš„è¿›åˆ¶è½¬æ¢
var num = "e6186159d38cd50e0463a55e596336bd".FromBaseBig(16); // å¤§æ•°å­—16è¿›åˆ¶è½¬10è¿›åˆ¶
Console.WriteLine(num); // åè¿›åˆ¶ï¼š305849028665645097422198928560410015421
Console.WriteLine(num.ToBase(64)); // 64è¿›åˆ¶ï¼š3C665pQUPl3whzFlVpoPqZï¼Œ22ä½é•¿åº¦
Console.WriteLine(num.ToBase(36)); // 36è¿›åˆ¶ï¼šdmed4dkd5bhcg4qdktklun0zhï¼Œ25ä½é•¿åº¦
Console.WriteLine(num.ToBase(7)); // 7è¿›åˆ¶ï¼š2600240311641665565300424545154525131265221035ï¼Œ46ä½é•¿åº¦
Console.WriteLine(num.ToBase(12)); // 12è¿›åˆ¶ï¼š5217744842749978a756b22135b16a5998a5ï¼Œ36ä½é•¿åº¦
Console.WriteLine(num.ToBase(41)); // 41è¿›åˆ¶ï¼šopzeBda2aytcEeudEquuesbkï¼Œ24ä½é•¿åº¦
```
### 6.çº³ç§’çº§æ€§èƒ½è®¡æ—¶å™¨
```csharp
HiPerfTimer timer = HiPerfTimer.StartNew();
for (int i = 0; i < 100000; i++)
{
    //todo
}
timer.Stop();
Console.WriteLine("æ‰§è¡Œforå¾ªç¯100000æ¬¡è€—æ—¶"+timer.Duration+"s");
```
```csharp
double time = HiPerfTimer.Execute(() =>
{
    for (int i = 0; i < 100000; i++)
    {
        //todo
    }
});
Console.WriteLine("æ‰§è¡Œforå¾ªç¯100000æ¬¡è€—æ—¶"+time+"s");
```
### 7.äº§ç”Ÿåˆ†å¸ƒå¼å”¯ä¸€æœ‰åºçŸ­id(é›ªèŠ±id)
```csharp
var sf = SnowFlake.GetInstance();
string token = sf.GetUniqueId();// rcofqodori0w
string shortId = sf.GetUniqueShortId(8);// qodw9728
```
```csharp
var set = new HashSet<string>();
double time = HiPerfTimer.Execute(() =>
{
    for (int i = 0; i < 1000000; i++)
    {
        set.Add(SnowFlake.GetInstance().GetUniqueId());
    }
});
Console.WriteLine(set.Count == 1000000); //True
Console.WriteLine("äº§ç”Ÿ100wä¸ªidè€—æ—¶" + time + "s"); //2.6891495s
```
### 8.å†œå†è½¬æ¢
```csharp
ChineseCalendar.CustomHolidays.Add(DateTime.Parse("2018-12-31"),"å…ƒæ—¦èŠ‚");//è‡ªå®šä¹‰èŠ‚å‡æ—¥
ChineseCalendar today = new ChineseCalendar(DateTime.Parse("2018-12-31"));
Console.WriteLine(today.ChineseDateString);// äºŒé›¶ä¸€å…«å¹´åä¸€æœˆå»¿äº”
Console.WriteLine(today.AnimalString);// ç”Ÿè‚–ï¼šç‹—
Console.WriteLine(today.GanZhiDateString);// å¹²æ”¯ï¼šæˆŠæˆŒå¹´ç”²å­æœˆä¸é…‰æ—¥
Console.WriteLine(today.DateHoliday);// è·å–æŒ‰å…¬å†è®¡ç®—çš„èŠ‚å‡æ—¥
...
```
### 9.Linqè¡¨è¾¾å¼æ ‘æ‰©å±•
```csharp
Expression<Func<string, bool>> where1 = s => s.StartsWith("a");
Expression<Func<string, bool>> where2 = s => s.Length > 10;
Func<string, bool> func = where1.And(where2)
    .AndIf(!string.IsNullOrEmpty(name),s=>s==name)
    .Compile(); // Andå’ŒAndIfå¯ä¾›é€‰æ‹©ï¼Œæ»¡è¶³æ¡ä»¶å†æ‰§è¡ŒAnd
bool b=func("abcd12345678");//true
```
```csharp
Expression<Func<string, bool>> where1 = s => s.StartsWith("a");
Expression<Func<string, bool>> where2 = s => s.Length > 10;
Func<string, bool> func = where1
    .Or(where2)
    .OrIf(!string.IsNullOrEmpty(name),s=>s==name)
    .Compile(); // Orå’ŒOrIfå¯ä¾›é€‰æ‹©ï¼Œæ»¡è¶³æ¡ä»¶å†æ‰§è¡ŒOr
bool b=func("abc");// true
```
```csharp
queryable.WhereIf(!string.IsNullOrEmpty(name),e=>e.Name==name)
    .WhereIf(()=> age.HasValue,e=>e.Age>=age); // IQueryableçš„WhereIfæ‰©å±•å‡½æ•°ï¼Œæ»¡è¶³æ¡ä»¶å†æ‰§è¡ŒWhere
```
### 10.æ¨¡ç‰ˆå¼•æ“
```csharp
var tmp = new Template("{{name}}ï¼Œä½ å¥½ï¼");
tmp.Set("name", "ä¸‡é‡‘æ²¹");
string s = tmp.Render();//ä¸‡é‡‘æ²¹ï¼Œä½ å¥½ï¼
```
```csharp
var tmp = new Template("{{one}},{{two}},{{three}}");
string s = tmp.Set("one", "1").Set("two", "2").Set("three", "3").Render();// 1,2,3
```
```csharp
var tmp = new Template("{{name}}ï¼Œ{{greet}}ï¼");
tmp.Set("name", "ä¸‡é‡‘æ²¹");
string s = tmp.Render();// throw æ¨¡ç‰ˆå˜é‡{{greet}}æœªè¢«ä½¿ç”¨
```
### 11.Listè½¬Datatable
```csharp
var list = new List<MyClass>()
{
    new MyClass()
    {
        Name = "å¼ ä¸‰",
        Age = 22
    },
    new MyClass()
    {
        Name = "æå››",
        Age = 21
    },
    new MyClass()
    {
        Name = "ç‹äº”",
        Age = 28
    }
};
var table = list.Select(c => new{å§“å=c.Name,å¹´é¾„=c.Age}).ToDataTable();// å°†è‡ªåŠ¨å¡«å……åˆ—å§“åå’Œå¹´é¾„
```
### 12.æ–‡ä»¶å‹ç¼©è§£å‹
.NET Framework
```csharp
MemoryStream ms = SevenZipCompressor.ZipStream(new List<string>()
{
    @"D:\1.txt",
    "http://ww3.sinaimg.cn/large/87c01ec7gy1fsq6rywto2j20je0d3td0.jpg",
});//å‹ç¼©æˆå†…å­˜æµ
```
```csharp
SevenZipCompressor.Zip(new List<string>()
{
    @"D:\1.txt",
    "http://ww3.sinaimg.cn/large/87c01ec7gy1fsq6rywto2j20je0d3td0.jpg",
}, zip);//å‹ç¼©æˆzip
SevenZipCompressor.UnRar(@"D:\Download\test.rar", @"D:\Download\");//è§£å‹rar
SevenZipCompressor.Decompress(@"D:\Download\test.tar", @"D:\Download\");//è‡ªåŠ¨è¯†åˆ«è§£å‹å‹ç¼©åŒ…
SevenZipCompressor.Decompress(@"D:\Download\test.7z", @"D:\Download\");
```
ASP.NET Core

Startup.cs
```csharp
services.AddSevenZipCompressor();
```
æ„é€ å‡½æ•°æ³¨å…¥ISevenZipCompressor
```csharp
private readonly ISevenZipCompressor _sevenZipCompressor;
public Test(ISevenZipCompressor sevenZipCompressor)
{
    _sevenZipCompressor = sevenZipCompressor;
}
```
ä½¿ç”¨æ–¹å¼åŒ.NET Frameworkç‰ˆæœ¬
### 13.ç®€æ˜“æ—¥å¿—ç»„ä»¶(åˆä¸æ˜¯ä¸èƒ½ç”¨.jpg)
```csharp
LogManager.LogDirectory=AppDomain.CurrentDomain.BaseDirectory+"/logs";
LogManager.Event+=info =>
{
    //todo:æ³¨å†Œä¸€äº›äº‹ä»¶æ“ä½œ
};
LogManager.Info("è®°å½•ä¸€æ¬¡æ¶ˆæ¯");
LogManager.Error(new Exception("å¼‚å¸¸æ¶ˆæ¯"));
```
### 14.FTPå®¢æˆ·ç«¯
```csharp
FtpClient ftpClient = FtpClient.GetAnonymousClient("192.168.2.2");//åˆ›å»ºä¸€ä¸ªåŒ¿åè®¿é—®çš„å®¢æˆ·ç«¯
//FtpClient ftpClient = FtpClient.GetClient("192.168.2.3","admin","123456");// åˆ›å»ºä¸€ä¸ªå¸¦ç”¨æˆ·åå¯†ç çš„å®¢æˆ·ç«¯
ftpClient.Delete("/1.txt");// åˆ é™¤æ–‡ä»¶
ftpClient.Download("/test/2.txt","D:\\test\\2.txt");// ä¸‹è½½æ–‡ä»¶
ftpClient.UploadFile("/test/22.txt","D:\\test\\22.txt",(sum, progress) =>
{
    Console.WriteLine("å·²ä¸Šä¼ ï¼š"+progress*1.0/sum);
});//ä¸Šä¼ æ–‡ä»¶å¹¶æ£€æµ‹è¿›åº¦
List<string> files = ftpClient.GetFiles("/");//åˆ—å‡ºftpæœåŠ¡ç«¯æ–‡ä»¶åˆ—è¡¨
...
```
### 15.å¤šçº¿ç¨‹åå°ä¸‹è½½
```csharp
var mtd = new MultiThreadDownloader("https://attachments-cdn.shimo.im/yXwC4kphjVQu06rH/KeyShot_Pro_7.3.37.7z",Environment.GetEnvironmentVariable("temp"),"E:\\Downloads\\KeyShot_Pro_7.3.37.7z",8);
mtd.Configure(req =>
 {
     req.Referer = "https://masuit.com";
     req.Headers.Add("Origin", "https://baidu.com");
});
mtd.TotalProgressChanged+=(sender, e) =>
{
    var downloader = sender as MultiThreadDownloader;
    Console.WriteLine("ä¸‹è½½è¿›åº¦ï¼š"+downloader.TotalProgress+"%");
    Console.WriteLine("ä¸‹è½½é€Ÿåº¦ï¼š"+downloader.TotalSpeedInBytes/1024/1024+"MBps");
};
mtd.FileMergeProgressChanged+=(sender, e) =>
{
    Console.WriteLine("ä¸‹è½½å®Œæˆ");
};
mtd.FileMergedComplete+=(sender,e)=>{
    Console.WriteLine("æ–‡ä»¶åˆå¹¶å®Œæˆ");
};
mtd.Start();//å¼€å§‹ä¸‹è½½
//mtd.Pause(); // æš‚åœä¸‹è½½
//mtd.Resume(); // ç»§ç»­ä¸‹è½½
```
### 16.åŠ å¯†è§£å¯†/hash
```csharp
var enc="123456".MDString();// MD5
var enc="123456".MDString("abc");// MD5åŠ ç›
var enc="123456".MDString2();// MD5ä¸¤æ¬¡
var enc="123456".MDString2("abc");// MD5ä¸¤æ¬¡åŠ ç›
var enc="123456".MDString3();// MD5ä¸‰æ¬¡
var enc="123456".MDString3("abc");// MD5ä¸‰æ¬¡åŠ ç›

string aes = "123456".AESEncrypt();// AESåŠ å¯†ä¸ºå¯†æ–‡
string s = aes.AESDecrypt(); //AESè§£å¯†ä¸ºæ˜æ–‡
string aes = "123456".AESEncrypt("abc");// AESå¯†é’¥åŠ å¯†ä¸ºå¯†æ–‡
string s = aes.AESDecrypt("abc"); //AESå¯†é’¥è§£å¯†ä¸ºæ˜æ–‡

string enc = "123456".DesEncrypt();// DESåŠ å¯†ä¸ºå¯†æ–‡
string s = enc.DesDecrypt(); //DESè§£å¯†ä¸ºæ˜æ–‡
string enc = "123456".DesEncrypt("abcdefgh");// DESå¯†é’¥åŠ å¯†ä¸ºå¯†æ–‡
string s = enc.DesDecrypt("abcdefgh"); //DESå¯†é’¥è§£å¯†ä¸ºæ˜æ–‡

RsaKey rsaKey = RsaCrypt.GenerateRsaKeys();// ç”ŸæˆRSAå¯†é’¥å¯¹
string encrypt = "123456".RSAEncrypt(rsaKey.PublicKey);// å…¬é’¥åŠ å¯†
string s = encrypt.RSADecrypt(rsaKey.PrivateKey);// ç§é’¥è§£å¯†

string s = "123".Crc32();// ç”Ÿæˆcrc32æ‘˜è¦
string s = "123".Crc64();// ç”Ÿæˆcrc64æ‘˜è¦
string s = "123".SHA256();// ç”ŸæˆSHA256æ‘˜è¦

string pub="hello,world!";
string hidden="ldqk";
var str = pub.InjectZeroWidthString(hidden); // æ‰©å±•å‡½æ•°è°ƒç”¨ï¼šå°†"ldqk"ä»¥é›¶å®½å­—ç¬¦ä¸²çš„æ–¹å¼éšè—åœ¨"hello,world!"ä¸­
var str = ZeroWidthCodec.Encrypt(pub,hidden); // ç±»è°ƒç”¨ï¼šå°†"ldqk"ä»¥é›¶å®½å­—ç¬¦ä¸²çš„æ–¹å¼éšè—åœ¨"hello,world!"ä¸­
var dec = str.DecodeZeroWidthString(); // æ‰©å±•å‡½æ•°è°ƒç”¨ï¼šå°†åŒ…å«é›¶å®½å­—ç¬¦ä¸²çš„å¯†æ–‡è§£å¯†å‡ºéšè—å­—ç¬¦ä¸²"ldqk"
var dec = ZeroWidthCodec.Decrypt(str); // ç±»è°ƒç”¨ï¼šå°†åŒ…å«é›¶å®½å­—ç¬¦ä¸²çš„å¯†æ–‡è§£å¯†å‡ºéšè—å­—ç¬¦ä¸²"ldqk"
var enc = hidden.EncodeToZeroWidthText(); // æ‰©å±•å‡½æ•°è°ƒç”¨ï¼šå°†å­—ç¬¦ä¸²ç¼–ç æˆé›¶å®½å­—ç¬¦ä¸²
var enc = ZeroWidthCodec.Encode(); // ç±»è°ƒç”¨ï¼šå°†å­—ç¬¦ä¸²ç¼–ç æˆé›¶å®½å­—ç¬¦ä¸²
```
### 17.å®ä½“æ ¡éªŒ
```csharp
public class MyClass
{
    [IsEmail] //å¯åœ¨appsetting.jsonä¸­æ·»åŠ EmailDomainWhiteListé…ç½®é‚®ç®±åŸŸåç™½åå•ï¼Œé€—å·åˆ†éš”
    public string Email { get; set; }

    [IsPhone]
    public string PhoneNumber { get; set; }

    [IsIPAddress]
    public string IP { get; set; }

    [MinValue(0, ErrorMessage = "å¹´é¾„æœ€å°ä¸º0å²"), MaxValue(100, ErrorMessage = "å¹´é¾„æœ€å¤§100å²")]
    public int Age { get; set; }

    [ComplexPassword]//å¯†ç å¤æ‚åº¦æ ¡éªŒ
    public string Password { get; set; }
    
    [EnumOf] // æ£€æµ‹æ˜¯å¦æ˜¯æœ‰æ•ˆæšä¸¾å€¼
    public MyEnum MyEnum { get; set; }
    
    [MinItemsCount(1)] // æ£€æµ‹é›†åˆå…ƒç´ æœ€å°‘1ä¸ª
    public List<string> Strs { get; set; }
}
```
### 18.HTMLæ“ä½œ
```csharp
List<string> srcs = "html".MatchImgSrcs().ToList();// è·å–htmlå­—ç¬¦ä¸²é‡Œæ‰€æœ‰çš„imgæ ‡ç­¾çš„srcå±æ€§
var imgTags = "html".MatchImgTags();//è·å–htmlå­—ç¬¦ä¸²é‡Œçš„æ‰€æœ‰çš„imgæ ‡ç­¾
var str="html".RemoveHtmlTag(); // å»é™¤htmlæ ‡ç­¾
...
```
### 19.DateTimeæ‰©å±•
```csharp
double milliseconds = DateTime.Now.GetTotalMilliseconds();// è·å–æ¯«ç§’çº§æ—¶é—´æˆ³
double microseconds = DateTime.Now.GetTotalMicroseconds();// è·å–å¾®ç§’çº§æ—¶é—´æˆ³
double nanoseconds = DateTime.Now.GetTotalNanoseconds();// è·å–çº³ç§’çº§æ—¶é—´æˆ³
double seconds = DateTime.Now.GetTotalSeconds();// è·å–ç§’çº§æ—¶é—´æˆ³
double minutes = DateTime.Now.GetTotalMinutes();// è·å–åˆ†é’Ÿçº§æ—¶é—´æˆ³
...
```
### 20.IPåœ°å€å’ŒURL
```csharp
bool inRange = "192.168.2.2".IpAddressInRange("192.168.1.1","192.168.3.255");// åˆ¤æ–­IPåœ°å€æ˜¯å¦åœ¨è¿™ä¸ªåœ°å€æ®µé‡Œ
bool isPrivateIp = "172.16.23.25".IsPrivateIP();// åˆ¤æ–­æ˜¯å¦æ˜¯ç§æœ‰åœ°å€
bool isExternalAddress = "http://baidu.com".IsExternalAddress();// åˆ¤æ–­æ˜¯å¦æ˜¯å¤–ç½‘çš„URL

//ä»¥ä¸‹éœ€è¦é…ç½®baiduAK
string isp = "114.114.114.114".GetISP(); // è·å–ISPè¿è¥å•†ä¿¡æ¯
PhysicsAddress physicsAddress = "114.114.114.114".GetPhysicsAddressInfo().Result;// è·å–è¯¦ç»†åœ°ç†ä¿¡æ¯å¯¹è±¡
Tuple<string, List<string>> ipAddressInfo = "114.114.114.114".GetIPAddressInfo().Result;// è·å–è¯¦ç»†åœ°ç†ä¿¡æ¯é›†åˆ
```
### 21.å…ƒç´ å»é‡
```csharp
var list = new List<MyClass>()
{
    new MyClass()
    {
        Email = "1@1.cn"
    },
    new MyClass()
    {
        Email = "1@1.cn"
    },
    new MyClass()
    {
        Email = "1@1.cn"
    }
};
List<MyClass> classes = list.DistinctBy(c => c.Email).ToList();
Console.WriteLine(classes.Count==1);//True
```

### 22.æšä¸¾æ‰©å±•
```csharp
public enum MyEnum
{
    [Display(Name = "è¯»")]
    [Description("è¯»")]
    Read,
    
    [Display(Name = "å†™")]
    [Description("å†™")]
    Write
}
```
```csharp
Dictionary<int, string> dic1 = typeof(MyEnum).GetDictionary();// è·å–æšä¸¾å€¼å’Œå­—ç¬¦ä¸²è¡¨ç¤ºçš„å­—å…¸æ˜ å°„
var dic2 = typeof(MyEnum).GetDescriptionAndValue();// è·å–å­—ç¬¦ä¸²è¡¨ç¤ºå’Œæšä¸¾å€¼çš„å­—å…¸æ˜ å°„
string desc = MyEnum.Read.GetDescription();// è·å–Descriptionæ ‡ç­¾
string display = MyEnum.Read.GetDisplay();// è·å–Displayæ ‡ç­¾çš„Nameå±æ€§
var value = typeof(MyEnum).GetValue("Read");//è·å–å­—ç¬¦ä¸²è¡¨ç¤ºå€¼å¯¹åº”çš„æšä¸¾å€¼
string enumString = 0.ToEnumString(typeof(MyEnum));// è·å–æšä¸¾å€¼å¯¹åº”çš„å­—ç¬¦ä¸²è¡¨ç¤º
```
### 23.å®šé•¿é˜Ÿåˆ—å’ŒConcurrentHashSetå®ç°
`å¦‚æœæ˜¯.NET5åŠä»¥ä¸Šï¼Œæ¨èä½¿ç”¨æ¡†æ¶è‡ªå¸¦çš„Channelå®ç°è¯¥åŠŸèƒ½`
```csharp
LimitedQueue<string> queue = new LimitedQueue<string>(32);// å£°æ˜ä¸€ä¸ªå®¹é‡ä¸º32ä¸ªå…ƒç´ çš„å®šé•¿é˜Ÿåˆ—
ConcurrentLimitedQueue<string> queue = new ConcurrentLimitedQueue<string>(32);// å£°æ˜ä¸€ä¸ªå®¹é‡ä¸º32ä¸ªå…ƒç´ çš„çº¿ç¨‹å®‰å…¨çš„å®šé•¿é˜Ÿåˆ—
```
```csharp
var set = new ConcurrentHashSet<string>(); // ç”¨æ³•å’Œhashsetä¿æŒä¸€è‡´
```
### 24.åå°„æ“ä½œ
```csharp
MyClass myClass = new MyClass();
PropertyInfo[] properties = myClass.GetProperties();// è·å–å±æ€§åˆ—è¡¨
myClass.SetProperty("Email","1@1.cn");//ç»™å¯¹è±¡è®¾ç½®å€¼
myClass.DeepClone(); // å¯¹è±¡æ·±æ‹·è´ï¼Œå¸¦åµŒå¥—å±‚çº§çš„
```
### 25.è·å–çº¿ç¨‹å†…å”¯ä¸€å¯¹è±¡
```csharp
CallContext<T>.SetData("db",dbContext);//è®¾ç½®çº¿ç¨‹å†…å”¯ä¸€å¯¹è±¡
CallContext<T>.GetData("db");//è·å–çº¿ç¨‹å†…å”¯ä¸€å¯¹è±¡
```
### 26.é‚®ä»¶å‘é€
```csharp
new Email()
{
    SmtpServer = "smtp.masuit.com",// SMTPæœåŠ¡å™¨
    SmtpPort = 25, // SMTPæœåŠ¡å™¨ç«¯å£
    EnableSsl = true,//ä½¿ç”¨SSL
    Username = "admin@masuit.com",// é‚®ç®±ç”¨æˆ·å
    Password = "123456",// é‚®ç®±å¯†ç 
    Tos = "10000@qq.com,10001@qq.com", //æ”¶ä»¶äºº
    Subject = "æµ‹è¯•é‚®ä»¶",//é‚®ä»¶æ ‡é¢˜
    Body = "ä½ å¥½å•Š",//é‚®ä»¶å†…å®¹
}.SendAsync(s =>
{
    Console.WriteLine(s);// å‘é€æˆåŠŸåçš„å›è°ƒ
});// å¼‚æ­¥å‘é€é‚®ä»¶
```
### 27.å›¾åƒçš„ç®€å•å¤„ç†
```csharp
ImageUtilities.CompressImage(@"F:\src\1.jpg", @"F:\dest\2.jpg");//æ— æŸå‹ç¼©å›¾ç‰‡

"base64".SaveDataUriAsImageFile();// å°†Base64ç¼–ç è½¬æ¢æˆå›¾ç‰‡

Image image = Image.FromFile(@"D:\1.jpg");
image.MakeThumbnail(@"D:\2.jpg", 120, 80, ThumbnailCutMode.LockWidth);//ç”Ÿæˆç¼©ç•¥å›¾

Bitmap bmp = new Bitmap(@"D:\1.jpg");
Bitmap newBmp = bmp.BWPic(bmp.Width, bmp.Height);//è½¬æ¢æˆé»‘ç™½
Bitmap newBmp = bmp.CutAndResize(new Rectangle(0, 0, 1600, 900), 160, 90);//è£å‰ªå¹¶ç¼©æ”¾
bmp.RevPicLR(bmp.Width, bmp.Height);//å·¦å³é•œåƒ
bmp.RevPicUD(bmp.Width, bmp.Height);//ä¸Šä¸‹é•œåƒ

var marker=ImageWatermarker(stream);
stream=maker.AddWatermark("æ°´å°æ–‡å­—","å­—ä½“æ–‡ä»¶",å­—ä½“å¤§å°,color,æ°´å°ä½ç½®,è¾¹è·); // ç»™å›¾ç‰‡æ·»åŠ æ°´å°
stream=maker.AddWatermark(æ°´å°å›¾ç‰‡,æ°´å°ä½ç½®,è¾¹è·,å­—ä½“å¤§å°,å­—ä½“); // ç»™å›¾ç‰‡æ·»åŠ æ°´å°

// å›¾åƒç›¸ä¼¼åº¦å¯¹æ¯”
var hasher = new ImageHasher();
var hash1 = hasher.DifferenceHash256("å›¾ç‰‡1"); // ä½¿ç”¨å·®åˆ†å“ˆå¸Œç®—æ³•è®¡ç®—å›¾åƒçš„256ä½å“ˆå¸Œ
var hash2 = hasher.DifferenceHash256("å›¾ç‰‡2"); // ä½¿ç”¨å·®åˆ†å“ˆå¸Œç®—æ³•è®¡ç®—å›¾åƒçš„256ä½å“ˆå¸Œ
//var hash1 = hasher.AverageHash64("å›¾ç‰‡1"); // ä½¿ç”¨å¹³å‡å€¼ç®—æ³•è®¡ç®—å›¾åƒçš„64ä½å“ˆå¸Œ
//var hash2 = hasher.AverageHash64("å›¾ç‰‡2"); // ä½¿ç”¨å¹³å‡å€¼ç®—æ³•è®¡ç®—å›¾åƒçš„64ä½å“ˆå¸Œ
//var hash1 = hasher.DctHash("å›¾ç‰‡1"); // ä½¿ç”¨DCTç®—æ³•è®¡ç®—å›¾åƒçš„64ä½å“ˆå¸Œ
//var hash2 = hasher.DctHash("å›¾ç‰‡2"); // ä½¿ç”¨DCTç®—æ³•è®¡ç®—å›¾åƒçš„64ä½å“ˆå¸Œ
//var hash1 = hasher.MedianHash64("å›¾ç‰‡1"); // ä½¿ç”¨ä¸­å€¼ç®—æ³•è®¡ç®—ç»™å®šå›¾åƒçš„64ä½å“ˆå¸Œ
//var hash2 = hasher.MedianHash64("å›¾ç‰‡2"); // ä½¿ç”¨ä¸­å€¼ç®—æ³•è®¡ç®—ç»™å®šå›¾åƒçš„64ä½å“ˆå¸Œ
var sim=ImageHasher.Compare(hash1,hash2); // å›¾ç‰‡çš„ç›¸ä¼¼åº¦ï¼ŒèŒƒå›´ï¼š[0,1]

var imageFormat=stream.GetImageType(); // è·å–å›¾ç‰‡çš„çœŸå®æ ¼å¼
```
### 28.éšæœºæ•°
```csharp
Random rnd = new Random();
int num = rnd.StrictNext();//äº§ç”ŸçœŸéšæœºæ•°
double gauss = rnd.NextGauss(20,5);//äº§ç”Ÿæ­£æ€é«˜æ–¯åˆ†å¸ƒçš„éšæœºæ•°
var s = new NumberFormater(62).ToString(new Random().Next(100000, int.MaxValue));//ç”Ÿæˆéšæœºå­—ç¬¦ä¸²
```
### 29.æƒé‡ç­›é€‰åŠŸèƒ½
```csharp
var data=new List<WeightedItem<string>>()
{
     new WeightedItem<string>("A", 1),
     new WeightedItem<string>("B", 3),
     new WeightedItem<string>("C", 4),
     new WeightedItem<string>("D", 4),
};
var item=data.WeightedItem();//æŒ‰æƒé‡é€‰å‡º1ä¸ªå…ƒç´ 
var list=data.WeightedItems(2);//æŒ‰æƒé‡é€‰å‡º2ä¸ªå…ƒç´ 
```
```csharp
var selector = new WeightedSelector<string>(new List<WeightedItem<string>>()
{
    new WeightedItem<string>("A", 1),
    new WeightedItem<string>("B", 3),
    new WeightedItem<string>("C", 4),
    new WeightedItem<string>("D", 4),
});
var item = selector.Select();//æŒ‰æƒé‡é€‰å‡º1ä¸ªå…ƒç´ 
var list = selector.SelectMultiple(3);//æŒ‰æƒé‡é€‰å‡º3ä¸ªå…ƒç´ 
```
### 30.EF Coreæ”¯æŒAddOrUpdateæ–¹æ³•
```csharp
/// <summary>
/// æŒ‰Idæ·»åŠ æˆ–æ›´æ–°æ–‡ç« å®ä½“
/// </summary>
public override Post SavePost(Post t)
{
    DataContext.Set<Post>().AddOrUpdate(t => t.Id, t);
    return t;
}
```
### 31.æ•æ„Ÿä¿¡æ¯æ©ç 
```csharp
"13123456789".Mask(); // 131****5678
"admin@masuit.com".MaskEmail(); // a****n@masuit.com
```
### 32.é›†åˆæ‰©å±•
```csharp
var list = new List<string>()
{
    "1","3","3","3"
};
list.AddRangeIf(s => s.Length > 1, "1", "11"); // å°†è¢«æ·»åŠ å…ƒç´ ä¸­çš„é•¿åº¦å¤§äº1çš„å…ƒç´ æ·»åŠ åˆ°list
list.AddRangeIfNotContains("1", "11"); // å°†è¢«æ·»åŠ å…ƒç´ ä¸­ä¸åŒ…å«çš„å…ƒç´ æ·»åŠ åˆ°list
list.RemoveWhere(s => s.Length<1); // å°†é›†åˆä¸­é•¿åº¦å°äº1çš„å…ƒç´ ç§»é™¤
list.InsertAfter(0, "2"); // åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ ä¹‹åæ’å…¥
list.InsertAfter(s => s == "1", "2"); // åœ¨å…ƒç´ "1"åæ’å…¥
var dic = list.ToDictionarySafety(s => s); // å®‰å…¨çš„è½¬æ¢æˆå­—å…¸ç±»å‹ï¼Œå½“é”®é‡å¤æ—¶åªæ·»åŠ ä¸€ä¸ªé”®
var dic = list.ToConcurrentDictionary(s => s); // è½¬æ¢æˆå¹¶å‘å­—å…¸ç±»å‹ï¼Œå½“é”®é‡å¤æ—¶åªæ·»åŠ ä¸€ä¸ªé”®
var dic = list.ToDictionarySafety(s => s, s => s.GetHashCode()); // å®‰å…¨çš„è½¬æ¢æˆå­—å…¸ç±»å‹ï¼Œå½“é”®é‡å¤æ—¶åªæ·»åŠ ä¸€ä¸ªé”®
dic.AddOrUpdate("4", 4); // æ·»åŠ æˆ–æ›´æ–°é”®å€¼å¯¹
dic.AddOrUpdate(new Dictionary<string, int>()
{
    ["5"] = 5,["55"]=555
}); // æ‰¹é‡æ·»åŠ æˆ–æ›´æ–°é”®å€¼å¯¹
dic.AddOrUpdate("5", 6, (s, i) => 66); // å¦‚æœæ˜¯æ·»åŠ ï¼Œåˆ™å€¼ä¸º6ï¼Œè‹¥æ›´æ–°åˆ™å€¼ä¸º66
dic.AddOrUpdate("5", 6, 666); // å¦‚æœæ˜¯æ·»åŠ ï¼Œåˆ™å€¼ä¸º6ï¼Œè‹¥æ›´æ–°åˆ™å€¼ä¸º666
dic.GetOrAdd("7",77); // å­—å…¸è·å–æˆ–æ·»åŠ å…ƒç´ 
dic.GetOrAdd("7",()=>77); // å­—å…¸è·å–æˆ–æ·»åŠ å…ƒç´ 
dic.AsConcurrentDictionary(); // æ™®é€šå­—å…¸è½¬æ¢æˆå¹¶å‘å­—å…¸é›†åˆ
var table=list.ToDataTable(); // è½¬æ¢æˆDataTableç±»å‹
table.AddIdentityColumn(); //ç»™DataTableå¢åŠ ä¸€ä¸ªè‡ªå¢åˆ—
table.HasRows(); // æ£€æŸ¥DataTable æ˜¯å¦æœ‰æ•°æ®è¡Œ
table.ToList<T>(); // datatableè½¬List
var set = list.ToHashSet(s=>s.Name);// è½¬HashSet
var cts = new CancellationTokenSource(100); //å–æ¶ˆå£ä»¤
await list.ForeachAsync(async i=>{
    await Task.Delay(100);
    Console.WriteLine(i);
},cts.Token); // å¼‚æ­¥foreach

await list.ForAsync(async (item,index)=>{
    await Task.Delay(100);
    Console.WriteLine(item+"_"+index);
},cts.Token); // å¼‚æ­¥forï¼Œå¸¦ç´¢å¼•ç¼–å·
await list.SelectAsync(async i=>{
    await Task.Delay(100);
    return i*10;
}); // å¼‚æ­¥Select
await list.SelectAsync(async (item,index)=>{
    await Task.Delay(100);
    return item*10;
}); // å¼‚æ­¥Selectï¼Œå¸¦ç´¢å¼•ç¼–å·
string s=list.Join(",");//å°†å­—ç¬¦ä¸²é›†åˆè¿æ¥æˆé€—å·åˆ†éš”çš„å•å­—ç¬¦ä¸²
var max=list.MaxOrDefault(); // å–æœ€å¤§å€¼ï¼Œå½“é›†åˆä¸ºç©ºçš„æ—¶å€™ä¸ä¼šæŠ¥é”™
var max=list.MaxOrDefault(selector); // å–æœ€å¤§å€¼ï¼Œå½“é›†åˆä¸ºç©ºçš„æ—¶å€™ä¸ä¼šæŠ¥é”™
var max=list.MaxOrDefault(selector,default); // å–æœ€å¤§å€¼ï¼Œå½“é›†åˆä¸ºç©ºçš„æ—¶å€™ä¸ä¼šæŠ¥é”™
var max=list.MinOrDefault(); // å–æœ€å°å€¼ï¼Œå½“é›†åˆä¸ºç©ºçš„æ—¶å€™ä¸ä¼šæŠ¥é”™
var max=list.MinOrDefault(selector); // å–æœ€å°å€¼ï¼Œå½“é›†åˆä¸ºç©ºçš„æ—¶å€™ä¸ä¼šæŠ¥é”™
var max=list.MinOrDefault(selector,default); // å–æœ€å°å€¼ï¼Œå½“é›†åˆä¸ºç©ºçš„æ—¶å€™ä¸ä¼šæŠ¥é”™
var stdDev=list.Select(s=>s.ConvertTo<int>()).StandardDeviation(); // æ±‚æ ‡å‡†å·®

var pages=queryable.ToPagedList(1,10); // åˆ†é¡µæŸ¥è¯¢
var pages=await queryable.ToPagedListAsync(1,10); // åˆ†é¡µæŸ¥è¯¢

var nums=Enumerable.Range(1, 10).ExceptBy(Enumerable.Range(5, 10), i => i); // æŒ‰å­—æ®µå–å·®é›†
var nums=Enumerable.Range(1, 10).IntersectBy(Enumerable.Range(5, 10), i => i); // æŒ‰å­—æ®µå–äº¤é›†
var nums=Enumerable.Range(1, 10).SequenceEqual(Enumerable.Range(5, 10), i => i); // åˆ¤æ–­åºåˆ—ç›¸ç­‰
var nums=Enumerable.Range(1, 10).OrderByRandom(); // éšæœºæ’åº

// å¤šä¸ªé›†åˆå–äº¤é›†
var list=new List<List<MyClass>>(){
    new List<MyClass>(){
        new MyClass(){Name="aa",Age=11},
        new MyClass(){Name="bb",Age=12},
        new MyClass(){Name="cc",Age=13},
    },
    new List<MyClass>(){
        new MyClass(){Name="bb",Age=12},
        new MyClass(){Name="cc",Age=13},
        new MyClass(){Name="dd",Age=14},
    },
    new List<MyClass>(){
        new MyClass(){Name="cc",Age=13},
        new MyClass(){Name="dd",Age=14},
        new MyClass(){Name="ee",Age=15},
    },
};
var sect=list.IntersectAll(m=>m.Name); // new MyClass(){Name="cc",Age=13}

var list=new List<List<int>>(){
    new(){1,2,3},
    new(){2,3,4},
    new(){3,4,5}
};
var sect=list.IntersectAll();// [3]

// é›†åˆå…ƒç´ æ”¹å˜å…¶ç´¢å¼•ä½ç½®
list.ChangeIndex(item,3); // å°†å…ƒç´ itemçš„ç´¢å¼•ä½ç½®å˜ä¸ºç¬¬3ä¸ª
list.ChangeIndex(t=>t.Id=="123",2); // å°†idä¸º123çš„å…ƒç´ çš„ç´¢å¼•ä½ç½®å˜ä¸ºç¬¬2ä¸ª
```
### 33.Mimeç±»å‹
```csharp
var mimeMapper = new MimeMapper();
var ext = mimeMapper.GetExtensionFromMime("image/jpeg"); // .jpg
var mime = mimeMapper.GetMimeFromExtension(".jpg"); // image/jpeg
```
### 34.æ—¥æœŸæ—¶é—´æ‰©å±•
```csharp
DateTime.Now.GetTotalSeconds(); // è·å–è¯¥æ—¶é—´ç›¸å¯¹äº1970-01-01 00:00:00çš„ç§’æ•°
DateTime.Now.GetTotalMilliseconds(); // è·å–è¯¥æ—¶é—´ç›¸å¯¹äº1970-01-01 00:00:00çš„æ¯«ç§’æ•°
DateTime.Now.GetTotalMicroseconds(); // è·å–è¯¥æ—¶é—´ç›¸å¯¹äº1970-01-01 00:00:00çš„å¾®ç§’æ•°
DateTime.Now.GetTotalNanoseconds(); // è·å–è¯¥æ—¶é—´ç›¸å¯¹äº1970-01-01 00:00:00çš„çº³ç§’æ•°
var indate=DateTime.Parse("2020-8-3").In(DateTime.Parse("2020-8-2"),DateTime.Parse("2020-8-4"));//true
DateTime time="2021-1-1 8:00:00".ToDateTime(); //å­—ç¬¦ä¸²è½¬DateTime

//æ—¶é—´æ®µè®¡ç®—å·¥å…·
var range = new DateTimeRange(DateTime.Parse("2020-8-3"), DateTime.Parse("2020-8-5"));
range.Union(DateTime.Parse("2020-8-4"), DateTime.Parse("2020-8-6")); //è¿æ¥ä¸¤ä¸ªæ—¶é—´æ®µï¼Œç»“æœï¼š2020-8-3~2020-8-6
range.In(DateTime.Parse("2020-8-3"), DateTime.Parse("2020-8-6"));//åˆ¤æ–­æ˜¯å¦åœ¨æŸä¸ªæ—¶é—´æ®µå†…ï¼Œtrue
var (intersected,range2) = range.Intersect(DateTime.Parse("2020-8-4"), DateTime.Parse("2020-8-6"));//ä¸¤ä¸ªæ—¶é—´æ®µæ˜¯å¦ç›¸äº¤ï¼Œ(true,2020-8-3~2020-8-4)
range.Contains(DateTime.Parse("2020-8-3"), DateTime.Parse("2020-8-4"));//åˆ¤æ–­æ˜¯å¦åŒ…å«æŸä¸ªæ—¶é—´æ®µï¼Œtrue
...
```
### 35.æµç›¸å…³
```csharp
stream.SaveAsMemoryStream(); // ä»»æ„æµè½¬æ¢æˆå†…å­˜æµ
stream.ToArray(); // ä»»æ„æµè½¬æ¢æˆäºŒè¿›åˆ¶æ•°ç»„
stream.ToArrayAsync(); // ä»»æ„æµè½¬æ¢æˆäºŒè¿›åˆ¶æ•°ç»„
stream.ShuffleCode(); // æµæ´—ç ï¼Œåœ¨æµçš„æœ«ç«¯éšå³å¢åŠ å‡ ä¸ªç©ºå­—èŠ‚ï¼Œé‡è¦æ•°æ®è¯·è°¨æ…ä½¿ç”¨ï¼Œå¯èƒ½é€ æˆæµæŸå

// æ± åŒ–å†…å­˜æµï¼Œç”¨æ³•ä¸MemorySteamä¿æŒä¸€è‡´
using var ms=PooledMemoryStream();

// å¤§å‹å†…å­˜æµ,æœ€å¤§å¯æ”¯æŒ1TBå†…å­˜æ•°æ®ï¼Œæ¨èå½“æ•°æ®æµå¤§äº2GBæ—¶ä½¿ç”¨ï¼Œç”¨æ³•ä¸MemorySteamä¿æŒä¸€è‡´
using var ms=LargeMemoryStream();

//æ–‡ä»¶æµå¿«é€Ÿå¤åˆ¶
FileStream fs = new FileStream(@"D:\boot.vmdk", FileMode.OpenOrCreate, FileAccess.ReadWrite);
{
        //fs.CopyToFile(@"D:\1.bak");//åŒæ­¥å¤åˆ¶å¤§æ–‡ä»¶
        fs.CopyToFileAsync(@"D:\1.bak");//å¼‚æ­¥å¤åˆ¶å¤§æ–‡ä»¶
        string md5 = fs.GetFileMD5Async().Result;//å¼‚æ­¥è·å–æ–‡ä»¶çš„MD5
        string sha1 = fs.GetFileSha1();//å¼‚æ­¥è·å–æ–‡ä»¶çš„SHA1
}
memoryStream.SaveFile("filename"); // å°†å†…å­˜æµè½¬å‚¨æˆæ–‡ä»¶
```
### 36.æ•°å€¼è½¬æ¢
```csharp
1.2345678901.Digits8(); // å°†å°æ•°æˆªæ–­ä¸º8ä½
1.23.ConvertTo<int>(); // å°æ•°è½¬int
1.23.ConvertTo<T>(); // å°æ•°è½¬TåŸºæœ¬ç±»å‹
bool b=1.23.TryConvertTo<T>(out result); // å°æ•°è½¬TåŸºæœ¬ç±»å‹
var num=1.2345.ToDecimal(2); //è½¬decimalå¹¶ä¿ç•™ä¸¤ä½å°æ•°
```
### 37.INIé…ç½®æ–‡ä»¶æ“ä½œ(ä»…æ”¯æŒWindows)
```csharp
INIFile ini=new INIFile("filename.ini");
ini.IniWriteValue(section,key,value); // å†™å€¼
ini.IniReadValue(section,key); // è¯»å€¼
ini.ClearAllSection(); // æ¸…ç©ºæ‰€æœ‰é…ç½®èŠ‚
ini.ClearSection(section); // æ¸…ç©ºé…ç½®èŠ‚
```
### 38.é›·è¾¾å›¾è®¡ç®—å¼•æ“
åº”ç”¨åœºæ™¯ï¼šè®¡ç®—ä¸¤ä¸ªå¤šè¾¹å½¢çš„ç›¸ä¼¼åº¦ï¼Œç”¨æˆ·ç”»åƒä¹‹ç±»çš„
```csharp
var points=RadarChartEngine.ComputeIntersection(chart1,chart2); //è·å–ä¸¤ä¸ªå¤šè¾¹å½¢çš„ç›¸äº¤åŒºåŸŸ
points.ComputeArea(); //è®¡ç®—å¤šè¾¹å½¢é¢ç§¯
```
### 39.æ ‘å½¢ç»“æ„å®ç°
åŸºæœ¬æ¥å£ç±»ï¼š  
ITreeChildrenï¼šå¸¦Childrenå±æ€§çš„æ¥å£  
ITreeParentï¼šå¸¦Parentå±æ€§çš„æ¥å£  
ITreeï¼šç»§æ‰¿ITreeParentå’ŒITreeChildrenï¼ŒåŒæ—¶å¤šäº†Nameå±æ€§  

ç›¸å…³æ‰©å±•æ–¹æ³•ï¼š
```csharp
trees.Filter(func); // ä»æ ‘å½¢é›†åˆä¸­è¿‡æ»¤
trees.Flatten(); // å°†æ•°æ®å¹³é“ºå¼€
tree.AllChildren(); // è·å–æ‰€æœ‰çš„å­çº§
tree.AllParent(); // è·å–æ‰€æœ‰çš„çˆ¶çº§
tree.IsRoot(); // æ˜¯å¦æ˜¯æ ¹èŠ‚ç‚¹
tree.IsLeaf(); // æ˜¯å¦æ˜¯å¶å­èŠ‚ç‚¹
tree.Level(); // æ‰€å¤„æ·±åº¦/å±‚çº§
tree.Path(); // å…¨è·¯å¾„

var tree=list.ToTree(c => c.Id, c => c.Pid);//ç»§æ‰¿è‡ªITreeParent<T>, ITreeChildren<T>çš„é›†åˆè½¬æ¢æˆæ ‘å½¢ç»“æ„
var tree=list.ToTreeGeneral(c => c.Id, c => c.Pid);//ä¸€èˆ¬çš„é›†åˆè½¬æ¢æˆæ ‘å½¢ç»“æ„
```
### 40.ç®€å•çš„Excelå¯¼å‡º
éœ€è¦é¢å¤–ä¾èµ–åŒ…ï¼š`Masuit.Tools.Excel`
```csharp
var stream=list.Select(item=>new{
    å§“å=item.Name,
    å¹´é¾„=item.Age,
    item.Gender,
    Avatar=Image.FromStream(filestream) //å›¾ç‰‡åˆ—
}).ToDataTable().ToExcel("Sheet1"); //è‡ªå®šä¹‰åˆ—åå¯¼å‡º
var stream=list.ToDataTable("Sheet1").ToExcel("æ–‡ä»¶å¯†ç ");
```
#### ä¸€äº›çº¦å®šè§„åˆ™ï¼š  
1. å›¾ç‰‡åˆ—æ”¯æŒStreamã€Bitmapã€IEnumerable<Stream>ã€IEnumerable<Bitmap>ã€IDictionary<string,Stream>ã€IDictionary<string,MemoryStream>ã€IDictionary<string,Bitmap>ç±»å‹ï¼›
2. å…¶ä¸­ï¼Œå¦‚æœæ˜¯IDictionaryç±»å‹çš„å›¾ç‰‡åˆ—ï¼Œå­—å…¸çš„é”®ä¸ºå›¾ç‰‡è¶…é“¾æ¥çš„å®Œæ•´urlï¼›
3. é»˜è®¤å­—æ®µåä½œä¸ºåˆ—åå¯¼å‡ºï¼›
4. è‹¥listæ˜¯ä¸€ä¸ªå…·ä½“çš„å¼ºç±»å‹ï¼Œé»˜è®¤ä¼šå…ˆæŸ¥æ‰¾æ¯ä¸ªå­—æ®µçš„Descriptionæ ‡è®°ï¼Œè‹¥æœ‰Descriptionæ ‡è®°ï¼Œåˆ™å–Descriptionæ ‡è®°ä½œä¸ºåˆ—åæ˜¾ç¤º
5. ToExcelæ–¹æ³•æ”¯æŒDataTableã€List<DataTable>ã€Dictionary<string, DataTable>ç±»å‹çš„ç›´æ¥è°ƒç”¨
   

### 41.EFCoreå®ä½“å¯¹æ¯”åŠŸèƒ½
è·å–æŒ‡å®šå®ä½“çš„å˜æ›´
```csharp
var changes=dbContext.GetChanges<Post>();//è·å–å˜æ›´å­—æ®µä¿¡æ¯
var added=dbContext.GetAdded<Post>();//è·å–æ·»åŠ çš„å®ä½“å­—æ®µä¿¡æ¯
var removed=dbContext.GetRemoved<Post>();//è·å–è¢«ç§»é™¤çš„å®ä½“å­—æ®µä¿¡æ¯  
var allchanges=dbContext.GetAllChanges<Post>();//è·å–å¢åˆ æ”¹çš„å®ä½“å­—æ®µä¿¡æ¯  
```
è·å–æ‰€æœ‰å®ä½“çš„å˜æ›´
```csharp
var changes=dbContext.GetChanges();//è·å–å˜æ›´å­—æ®µä¿¡æ¯
var added=dbContext.GetAdded();//è·å–æ·»åŠ çš„å®ä½“å­—æ®µä¿¡æ¯
var removed=dbContext.GetRemoved();//è·å–è¢«ç§»é™¤çš„å®ä½“å­—æ®µä¿¡æ¯  
var allchanges=dbContext.GetAllChanges();//è·å–å¢åˆ æ”¹çš„å®ä½“å­—æ®µä¿¡æ¯  
```
å¯¹æ¯”ä¿¡æ¯åŒ…å«å±æ€§ä¿¡æ¯ã€æ—§å€¼ã€æ–°å€¼ã€å®ä½“ä¿¡æ¯ã€é”®ä¿¡æ¯ã€å˜æ›´çŠ¶æ€ç­‰
### 42.ä»»ä½•ç±»å‹æ”¯æŒé“¾å¼è°ƒç”¨
```csharp
a.Next(func1).Next(func2).Next(func3);
"123".Next(s=>s.ToInt32()).Next(x=>x*2).Next(x=>Math.Log(x));
```
### 43.Newtonsoft.Jsonçš„åªå…è®¸å­—æ®µååºåˆ—åŒ–è¡Œä¸ºçš„å¥‘çº¦è§£é‡Šå™¨
#### DeserializeOnlyContractResolver
è¯¥è§£é‡Šå™¨é’ˆå¯¹ç±»å±æ€§è¢«DeserializeOnlyJsonPropertyAttributeæ ‡è®°çš„ï¼Œåœ¨ååºåˆ—åŒ–çš„æ—¶å€™ç”Ÿæ•ˆï¼Œåœ¨åºåˆ—åŒ–çš„æ—¶å€™å¿½ç•¥
```csharp
public class ClassDto
    {
        [DeserializeOnlyJsonProperty]
        public string MyProperty { get; set; }

        public int Num { get; set; }
    }
    
    JsonConvert.SerializeObject(new MyClass(),new JsonSerializerSettings()
    {
        ContractResolver = new DeserializeOnlyContractResolver() // é…ç½®ä½¿ç”¨DeserializeOnlyContractResolverè§£é‡Šå™¨
    });
```
å¦‚æœæ˜¯WebAPIå…¨å±€ä½¿ç”¨ï¼š
```csharp
        //åœ¨Startup.ConfigureServicesä¸­
        services.AddMvc().AddNewtonsoftJson(options =>
             {
                 var resolver = new DeserializeOnlyContractResolver();
                 resolver.NamingStrategy = new CamelCaseNamingStrategy();
                 options.SerializerSettings.ContractResolver = resolver;
             });
```
#### FallbackJsonPropertyResolver
è¯¥è§£é‡Šå™¨é’ˆå¯¹æŸä¸ªå±æ€§è®¾ç½®å¤šä¸ªåˆ«åï¼Œååºåˆ—åŒ–æ—¶æ”¯æŒå¤šä¸ªåˆ«åkeyè¿›è¡Œç»‘å®šï¼Œå¼¥è¡¥å®˜æ–¹JsonPropertyåˆ«åå±æ€§åªèƒ½è®¾ç½®å•ä¸€åˆ«åçš„ä¸è¶³
```csharp
    public class ClassDto
    {
        [FallbackJsonProperty("MyProperty","a","b")]
        public string MyProperty { get; set; }

        public int Num { get; set; }
    }
    
    JsonConvert.SerializeObject(new MyClass(),new JsonSerializerSettings()
    {
        ContractResolver = new FallbackJsonPropertyResolver() // é…ç½®ä½¿ç”¨FallbackJsonPropertyResolverè§£é‡Šå™¨
    });
```
#### CompositeContractResolver
è¯¥è§£é‡Šå™¨æ˜¯DeserializeOnlyContractResolverå’ŒFallbackJsonPropertyResolverçš„èåˆç‰ˆ

### 44. ASP.NET Core ActionåŒæ—¶æ”¯æŒqueryStringã€è¡¨å•å’Œjsonè¯·æ±‚ç±»å‹çš„æ¨¡å‹ç»‘ç‚¹å™¨BodyOrDefaultModelBinder
ç”¨æ³•ï¼š  
å¼•å…¥åŒ…ï¼š`Masuit.Tools.AspNetCore`  
```shell
PM> Install-Package Masuit.Tools.AspNetCore
```
Startupé…ç½®ï¼š
```csharp
    services.AddMvc(options =>
        {
             options.ModelBinderProviders.InsertBodyOrDefaultBinding();
        })
```
åœ¨actionçš„å‚æ•°æ¨¡å‹å‰æ‰“ä¸Šæ ‡è®°ï¼š`[FromBodyOrDefault]`å³å¯ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥çœç•¥ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š
```csharp
        [HttpGet("query"),HttpPost("query")]
        public IActionResult Query([FromBodyOrDefault]QueryModel query)
        {
            return Ok(...);
        }
    
        [HttpGet("query"),HttpPost("query")]
        public IActionResult Query([FromBodyOrDefault]int id,[FromBodyOrDefault]string name)
        {
            return Ok(...);
        }
```

### 45. å­—ç¬¦ä¸²SimHashç›¸ä¼¼åº¦ç®—æ³•
```csharp
var dis="12345678".HammingDistance("1234567");
var dis=new SimHash("12345678").HammingDistance(new SimHash("1234567"));
```

### 46. çœŸå®æ–‡ä»¶ç±»å‹æ¢æµ‹
```csharp
// å¤šç§æ–¹å¼ï¼Œä»»å›è°ƒç”¨
var detector=new FileInfo(filepath).DetectFiletype();
//var detector=File.OpenRead(filepath).DetectFiletype();
//var detector=FileSignatureDetector.DetectFiletype(filepath);
detector.Precondition;//åŸºç¡€æ–‡ä»¶ç±»å‹
detector.Extension;//çœŸå®æ‰©å±•å
detector.MimeType;//MimeType
detector.FormatCategories;//æ ¼å¼ç±»åˆ«
```

#### é»˜è®¤æ”¯æŒçš„æ–‡ä»¶ç±»å‹
| æ‰©å±•å |       è¯´æ˜       |
|:-----------------:|:------------------:|
| 3GP               | 3GPP, 3GPP 2       |
| 7Z                | 7-Zip              |
| APK               | ZIP based Android Package |
| AVI               | Audio-Video Interleave |
| SH                | Shell Script       |
| BPLIST            | Binary Property List |
| BMP, DIB          | Bitmap             |
| BZ2               | Bunzip2 Compressed |
| CAB               | Microsoft Cabinet  |
| CLASS             | Java Bytecode      |
| CONFIG            | .NET Configuration File |
| CRT, CERT         | Certificate        |
| CUR               | Cursor             |
| DB                | Windows Thumbs.db Thumbnail Database |
| DDS               | DirectDraw Surface |
| DLL               | Windows Dynamic Linkage Library |
| DMG               | Apple Disk Mount Image |
| DMP               | Windows Memory Dump File |
| DOC               | Microsoft Office Word 97-2003 Document |
| DOCX              | Microsoft Office Word OpenXML Document |
| EPUB              | e-Pub Document     |
| EXE               | Windows Executive  |
| FLAC              | Loseless Audio     |
| FLV               | Flash Video        |
| GIF               | Graphics Interchage Format |
| GZ                | GZ Compressed      |
| HDP               | HD Photo(JPEG XR) Image |
| HWP               | Legacy HWP, HWPML, CFBF HWP |
| ICO               | Icon               |
| INI               | Initialization File |
| ISO               | ISO-9660 Disc Image |
| LNK               | Windows Shortcut Link |
| JP2               | JPEG 2000 Image    |
| JPG, JPEG         | Joint Photographic Experts Group Image |
| LZH               | LZH Compressed     |
| M4A               | MP4 Container Contained Audio Only |
| M4V               | MP4 Container Contained Video |
| MID               | Midi Sound         |
| MKA               | Matroska Container Contained Audio Only |
| MKV               | Matroska Container Contained Video |
| MOV               | QuickTime Movie Video |
| MP4               | MP4 Container Contained Contents |
| MSI               | Microsoft Installer |
| OGG               | OGG Video or Audio |
| ODF               | OpenDocument Formula |
| ODG               | OpenDocument Graphics |
| ODP               | OpenDocument Presentation |
| ODS               | OpenDocument Spreadsheet |
| ODT               | OpenDocument Text  |
| PAK               | PAK Archive or Quake Archive |
| PDB               | Microsoft Program Database |
| PDF               | Portable Document Format |
| PFX               | Microsoft Personal Information Exchange Certificate |
| PNG               | Portable Network Graphics Image |
| PPT               | Microsoft Office PowerPoint 97-2003 Document |
| PPTX              | Microsoft Office PowerPoint OpenXML Document |
| PPSX              | Microsoft Office PowerPoint OpenXML Document for Slideshow only |
| PSD               | Photoshop Document |
| RAR               | WinRAR Compressed  |
| REG               | Windows Registry   |
| RPM               | RedHat Package Manager Package |
| RTF               | Rich Text Format Document |
| SLN               | Microsoft Visual Studio Solution |
| SRT               | SubRip Subtitle    |
| SWF               | Shockwave Flash    |
| SQLITE, DB        | SQLite Database    |
| TAR               | pre-ISO Type and UStar Type TAR Package |
| TIFF              | Tagged Image File Format Image |
| TXT               | Plain Text         |
| WAV               | Wave Audio         |
| WASM              | Binary WebAssembly |
| WEBM              | WebM Video         |
| WEBP              | WebP Image         |
| XAR               | XAR Package        |
| XLS               | Microsoft Office Excel 97-2003 Document |
| XLSX              | Microsoft Office Excep OpenXML Document |
| XML               | Extensible Markup Language Document |
| Z                 | Z Compressed       |
| ZIP               | ZIP Package        |

# Asp.Net MVCå’ŒAsp.Net Coreçš„æ”¯æŒæ–­ç‚¹ç»­ä¼ å’Œå¤šçº¿ç¨‹ä¸‹è½½çš„ResumeFileResult

åœ¨ASP.NET Coreä¸­é€šè¿‡MVC/WebAPIåº”ç”¨ç¨‹åºä¼ è¾“æ–‡ä»¶æ•°æ®æ—¶ä½¿ç”¨æ–­ç‚¹ç»­ä¼ ä»¥åŠå¤šçº¿ç¨‹ä¸‹è½½æ”¯æŒã€‚

å®ƒæä¾›äº†`ETag`æ ‡å¤´ä»¥åŠ`Last-Modified`æ ‡å¤´ã€‚ å®ƒè¿˜æ”¯æŒä»¥ä¸‹å‰ç½®æ¡ä»¶æ ‡å¤´ï¼š`If-Match`ï¼Œ`If-None-Match`ï¼Œ`If-Modified-Since`ï¼Œ`If-Unmodified-Since`ï¼Œ`If-Range`ã€‚
## æ”¯æŒ ASP.NET Core 2.0+
ä».NET Core2.0å¼€å§‹ï¼ŒASP.NET Coreå†…éƒ¨æ”¯æŒæ–­ç‚¹ç»­ä¼ ã€‚ å› æ­¤åªæ˜¯å¯¹FileResultåšäº†ä¸€äº›æ‰©å±•ã€‚ åªç•™ä¸‹äº†â€œContent-Dispositionâ€ Inlineçš„ä¸€éƒ¨åˆ†ã€‚ æ‰€æœ‰ä»£ç éƒ½ä¾èµ–äºåŸºç¡€.NETç±»ã€‚

## å¦‚ä½•ä½¿ç”¨ 
### .NET Framework
åœ¨ä½ çš„æ§åˆ¶å™¨ä¸­ï¼Œä½ å¯ä»¥åƒåœ¨`FileResult`ä¸€æ ·çš„æ–¹å¼ä½¿ç”¨å®ƒã€‚
```csharp
using Masuit.Tools.Mvc;
using Masuit.Tools.Mvc.ResumeFileResult;
```

```csharp
private readonly MimeMapper mimeMapper=new MimeMapper(); // æ¨èä½¿ç”¨ä¾èµ–æ³¨å…¥

public ActionResult ResumeFileResult()
{
    var path = Server.MapPath("~/Content/test.mp4");
    return new ResumeFileResult(path, mimeMapper.GetMimeFromPath(path), Request);
}

public ActionResult ResumeFile()
{
    return this.ResumeFile("~/Content/test.mp4", mimeMapper.GetMimeFromPath(path), "test.mp4");
}

public ActionResult ResumePhysicalFile()
{
    return this.ResumePhysicalFile(@"D:/test.mp4", mimeMapper.GetMimeFromPath(@"D:/test.mp4"), "test.mp4");
}
```

### Asp.Net Core
è¦ä½¿ç”¨ResumeFileResultsï¼Œå¿…é¡»åœ¨`Startup.cs`çš„`ConfigureServices`æ–¹æ³•è°ƒç”¨ä¸­é…ç½®æœåŠ¡ï¼š

```csharp
using Masuit.Tools.AspNetCore.ResumeFileResults.Extensions;
```

```csharp
public void ConfigureServices(IServiceCollection services)
{
    services.AddResumeFileResult();
}
```

ç„¶ååœ¨ä½ çš„æ§åˆ¶å™¨ä¸­ï¼Œä½ å¯ä»¥åƒåœ¨`FileResult`ä¸€æ ·çš„æ–¹å¼ä½¿ç”¨å®ƒã€‚
<details>
    <summary>ç‚¹å‡»æŸ¥çœ‹ä»£ç </summary>

```csharp
using Masuit.Tools.AspNetCore.ResumeFileResults.Extensions;
```

```csharp
private const string EntityTag = "\"TestFile\"";

private readonly IHostingEnvironment _hostingEnvironment;

private readonly DateTimeOffset _lastModified = new DateTimeOffset(2016, 1, 1, 0, 0, 0, TimeSpan.Zero);

/// <summary>
/// 
/// </summary>
/// <param name="hostingEnvironment"></param>
public TestController(IHostingEnvironment hostingEnvironment)
{
    _hostingEnvironment = hostingEnvironment;
}

[HttpGet("content/{fileName}/{etag}")]
public IActionResult FileContent(bool fileName, bool etag)
{
    string webRoot = _hostingEnvironment.WebRootPath;
    var content = System.IO.File.ReadAllBytes(Path.Combine(webRoot, "TestFile.txt"));
    ResumeFileContentResult result = this.ResumeFile(content, "text/plain", fileName ? "TestFile.txt" : null, etag ? EntityTag : null);
    result.LastModified = _lastModified;
    return result;
}

[HttpGet("content/{fileName}")]
public IActionResult FileContent(bool fileName)
{
    string webRoot = _hostingEnvironment.WebRootPath;
    var content = System.IO.File.ReadAllBytes(Path.Combine(webRoot, "TestFile.txt"));
    var result = new ResumeFileContentResult(content, "text/plain")
    {
        FileInlineName = "TestFile.txt",
        LastModified = _lastModified
    };
    return result;
}

[HttpHead("file")]
public IActionResult FileHead()
{
    ResumeVirtualFileResult result = this.ResumeFile("TestFile.txt", "text/plain", "TestFile.txt", EntityTag);
    result.LastModified = _lastModified;
    return result;
}

[HttpPut("file")]
public IActionResult FilePut()
{
    ResumeVirtualFileResult result = this.ResumeFile("TestFile.txt", "text/plain", "TestFile.txt", EntityTag);
    result.LastModified = _lastModified;
    return result;
}

[HttpGet("stream/{fileName}/{etag}")]
public IActionResult FileStream(bool fileName, bool etag)
{
    string webRoot = _hostingEnvironment.WebRootPath;
    FileStream stream = System.IO.File.OpenRead(Path.Combine(webRoot, "TestFile.txt"));

    ResumeFileStreamResult result = this.ResumeFile(stream, "text/plain", fileName ? "TestFile.txt" : null, etag ? EntityTag : null);
    result.LastModified = _lastModified;
    return result;
}

[HttpGet("stream/{fileName}")]
public IActionResult FileStream(bool fileName)
{
    string webRoot = _hostingEnvironment.WebRootPath;
    FileStream stream = System.IO.File.OpenRead(Path.Combine(webRoot, "TestFile.txt"));

    var result = new ResumeFileStreamResult(stream, "text/plain")
    {
        FileInlineName = "TestFile.txt",
        LastModified = _lastModified
    };

    return result;
}

[HttpGet("physical/{fileName}/{etag}")]
public IActionResult PhysicalFile(bool fileName, bool etag)
{
    string webRoot = _hostingEnvironment.WebRootPath;

    ResumePhysicalFileResult result = this.ResumePhysicalFile(Path.Combine(webRoot, "TestFile.txt"), "text/plain", fileName ? "TestFile.txt" : null, etag ? EntityTag : null);
    result.LastModified = _lastModified;
    return result;
}

[HttpGet("physical/{fileName}")]
public IActionResult PhysicalFile(bool fileName)
{
    string webRoot = _hostingEnvironment.WebRootPath;

    var result = new ResumePhysicalFileResult(Path.Combine(webRoot, "TestFile.txt"), "text/plain")
    {
        FileInlineName = "TestFile.txt",
        LastModified = _lastModified
    };

    return result;
}

[HttpGet("virtual/{fileName}/{etag}")]
public IActionResult VirtualFile(bool fileName, bool etag)
{
    ResumeVirtualFileResult result = this.ResumeFile("TestFile.txt", "text/plain", fileName ? "TestFile.txt" : null, etag ? EntityTag : null);
    result.LastModified = _lastModified;
    return result;
}
```

ä»¥ä¸Šç¤ºä¾‹å°†ä¸ºæ‚¨çš„æ•°æ®æä¾›â€œContent-Dispositionï¼šattachmentâ€ã€‚ å½“æ²¡æœ‰æä¾›fileNameæ—¶ï¼Œæ•°æ®å°†ä½œä¸ºâ€œContent-Dispositionï¼šinlineâ€æä¾›ã€‚
å¦å¤–ï¼Œå®ƒå¯ä»¥æä¾›`ETag`å’Œ`LastModified`æ ‡å¤´ã€‚

```csharp
[HttpGet("virtual/{fileName}")]
public IActionResult VirtualFile(bool fileName)
{
    var result = new ResumeVirtualFileResult("TestFile.txt", "text/plain")
    {
        FileInlineName = "TestFile.txt",
        LastModified = _lastModified
    };
    return result;
}
```
</details>

### æ¨èé¡¹ç›®
åŸºäºEntityFrameworkCoreå’ŒLucene.NETå®ç°çš„å…¨æ–‡æ£€ç´¢æœç´¢å¼•æ“ï¼š[Masuit.LuceneEFCore.SearchEngine](https://github.com/ldqk/Masuit.LuceneEFCore.SearchEngine "Masuit.LuceneEFCore.SearchEngine")

å¼€æºåšå®¢ç³»ç»Ÿï¼š[Masuit.MyBlogs](https://github.com/ldqk/Masuit.MyBlogs "Masuit.MyBlogs")
